
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>pygen_structures package &#8212; pygen-structures 0.2 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="pygen-structures-package">
<h1>pygen_structures package<a class="headerlink" href="#pygen-structures-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="pygen_structures.mol_containers.html">pygen_structures.mol_containers package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pygen_structures.mol_containers.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygen_structures.mol_containers.html#module-pygen_structures.mol_containers.atom">pygen_structures.mol_containers.atom module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygen_structures.mol_containers.html#module-pygen_structures.mol_containers.molecule">pygen_structures.mol_containers.molecule module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygen_structures.mol_containers.html#module-pygen_structures.mol_containers.structure">pygen_structures.mol_containers.structure module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygen_structures.mol_containers.html#module-pygen_structures.mol_containers">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pygen_structures.charmm_containers">
<span id="pygen-structures-charmm-containers-module"></span><h2>pygen_structures.charmm_containers module<a class="headerlink" href="#module-pygen_structures.charmm_containers" title="Permalink to this headline">¶</a></h2>
<p>Module which stores classes intended to deal with CHARMM forcefield
data.</p>
<dl class="class">
<dt id="pygen_structures.charmm_containers.CHARMMParameterFile">
<em class="property">class </em><code class="sig-prename descclassname">pygen_structures.charmm_containers.</code><code class="sig-name descname">CHARMMParameterFile</code><span class="sig-paren">(</span><em class="sig-param">bonds: (&lt;class 'set'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">angles: (&lt;class 'set'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">dihedrals: (&lt;class 'set'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">impropers: (&lt;class 'set'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">cross_maps: (&lt;class 'set'&gt;</em>, <em class="sig-param">None) = None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMParameterFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A parser for CHARMM PRM files. Used for checking that parameters
exist for generated structures.</p>
<p>This class does not contain the values for the parameters, but
does ensure that the parameters themselves are present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bonds</strong> – set of tuples containing 2 <code class="docutils literal notranslate"><span class="pre">atom_type</span></code></p></li>
<li><p><strong>angles</strong> – set of tuples containing 3 <code class="docutils literal notranslate"><span class="pre">atom_type</span></code></p></li>
<li><p><strong>dihedrals</strong> – set of tuples containing 4 <code class="docutils literal notranslate"><span class="pre">atom_type</span></code></p></li>
<li><p><strong>impropers</strong> – set of tuples containing 4 <code class="docutils literal notranslate"><span class="pre">atom_type</span></code></p></li>
<li><p><strong>cross_maps</strong> – set of tuples containing 8 <code class="docutils literal notranslate"><span class="pre">atom_type</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMParameterFile.check_parameters">
<code class="sig-name descname">check_parameters</code><span class="sig-paren">(</span><em class="sig-param">molecule</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMParameterFile.check_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Check a finalized <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> to verify that all the parameters
in the <code class="docutils literal notranslate"><span class="pre">CHARMMParameterFile</span></code> exist for that molecule, returning
<code class="docutils literal notranslate"><span class="pre">True</span></code> if all parameters are present, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMParameterFile.from_file">
<em class="property">classmethod </em><code class="sig-name descname">from_file</code><span class="sig-paren">(</span><em class="sig-param">prm_path: str</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMParameterFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate the class from a CHARMM PRM file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prm_path</strong> – path to the .prm/.str file.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMParameterFile.get_unmatched">
<code class="sig-name descname">get_unmatched</code><span class="sig-paren">(</span><em class="sig-param">molecule</em><span class="sig-paren">)</span> &#x2192; Dict[str, Set[Tuple[str]]]<a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMParameterFile.get_unmatched" title="Permalink to this definition">¶</a></dt>
<dd><p>Check a finalized <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> to verify that all the parameters
in the <code class="docutils literal notranslate"><span class="pre">CHARMMParameterFile</span></code> exist for that molecule, returning
necessary parameters which are missing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molecule</strong> – the <code class="docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dict of parameter type (i.e. ‘bonds’/’angles’) to a         set of tuples containing unmatched <code class="docutils literal notranslate"><span class="pre">atom_type</span></code> tuples.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMParameterFile.read_file">
<code class="sig-name descname">read_file</code><span class="sig-paren">(</span><em class="sig-param">prm_path: str</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMParameterFile.read_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in data from a CHARMM PRM file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prm_path</strong> – path to .prm/.str file</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pygen_structures.charmm_containers.CHARMMPatchResidueDefinition">
<em class="property">class </em><code class="sig-prename descclassname">pygen_structures.charmm_containers.</code><code class="sig-name descname">CHARMMPatchResidueDefinition</code><span class="sig-paren">(</span><em class="sig-param">name: str = 'Unset'</em>, <em class="sig-param">atoms: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">bonds: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">impropers: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">cross_maps: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">ics: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">rtf_file_name: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">deletions: (&lt;class 'set'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">n_residues: int = 1</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMPatchResidueDefinition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygen_structures.charmm_containers.CHARMMResidueData" title="pygen_structures.charmm_containers.CHARMMResidueData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygen_structures.charmm_containers.CHARMMResidueData</span></code></a></p>
<p>Definition of a CHARMM patch residue. As CHARMM patches
can apply to multiple residues, these are more complicated
to represent than the residues they are applied to.</p>
<p><code class="docutils literal notranslate"><span class="pre">atoms</span></code>, <code class="docutils literal notranslate"><span class="pre">bonds</span></code>, <code class="docutils literal notranslate"><span class="pre">impropers</span></code>, <code class="docutils literal notranslate"><span class="pre">cross_maps</span></code> and <code class="docutils literal notranslate"><span class="pre">ics</span></code> are
<code class="docutils literal notranslate"><span class="pre">n_residues</span></code> long lists of the atoms, bonds, impropers,
cross_maps and ics for each residue. This enables these to be
zipped together with the actual residues the patch is to apply them
to.</p>
<p>Atoms, due to their simplicity, are kept as the form they are
stored in the residue:
- (<code class="docutils literal notranslate"><span class="pre">atom_name</span></code>, <code class="docutils literal notranslate"><span class="pre">atom_type</span></code>, <code class="docutils literal notranslate"><span class="pre">charge</span></code>)</p>
<p>In the other representations, atoms are stored as atom references.
These are tuples of <code class="docutils literal notranslate"><span class="pre">(residue_index:</span> <span class="pre">int,</span> <span class="pre">atom_name:</span> <span class="pre">str)</span></code>, where
<code class="docutils literal notranslate"><span class="pre">residue_index</span></code> is a placeholder for the order given in the patch.
- e.g. 2SG1 -&gt; <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">'SG1')</span></code>
- “BOND 1SG1 2SG1” -&gt; <code class="docutils literal notranslate"><span class="pre">((0,</span> <span class="pre">'SG1'),</span> <span class="pre">(1,</span> <span class="pre">'SG1'))</span></code></p>
<p>This is to account for new bonds/impropers/crossmaps/ics which involve
atoms in different residues.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – patch name, from PRES record</p></li>
<li><p><strong>atoms</strong> – an <code class="docutils literal notranslate"><span class="pre">n_residues</span></code> long list of lists containing    <code class="docutils literal notranslate"><span class="pre">(atom_name,</span> <span class="pre">atom_type,</span> <span class="pre">partial_charge)</span></code></p></li>
<li><p><strong>bonds</strong> – an <code class="docutils literal notranslate"><span class="pre">n_residues</span></code> long list of lists containing    tuples of 2 atom references, from BOND/DOUB records. Bonds    in DOUB records appear twice.</p></li>
<li><p><strong>impropers</strong> – an <code class="docutils literal notranslate"><span class="pre">n_residues</span></code> long list of lists containing    tuples of 4 atom references from IMPR records</p></li>
<li><p><strong>cross_maps</strong> – an <code class="docutils literal notranslate"><span class="pre">n_residues</span></code> long list of lists containing    tuples of 8 atom references from CMAP records</p></li>
<li><p><strong>ics</strong> – an <code class="docutils literal notranslate"><span class="pre">n_residues</span></code> long list of lists containing    lists of information present in IC records.    The first 4 items are atom references, the last 5 are floats    containing bond and angle information. Where angle i-j-k-l is an    improper, the third atom name is prefaced with “*”.        The floats are:    the bond length, i-j    the angle, i-j-k    the dihedral (or improper) i-j-k-l    the angle j-k-l    the bond length k-l</p></li>
<li><p><strong>deletions</strong> – set of atom names which are to be deleted from     the residue</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMPatchResidueDefinition.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param">*residues</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMPatchResidueDefinition.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the CHARMM patch to an actual residue (or collection of
actual residues).</p>
<p>Atoms to be deleted are removed from the applicable residues,
with now-dangling bonds/impropers/cross-maps/ICs to these
residues also removed.</p>
<p>New atoms, bonds, impropers, cross_maps and ics are then
appended to the relevant residue.</p>
<p>Bonds are added to the residue which contains the first atom,
all other multi-atom data is added to the residue which
contains the second atom. This is to account for the fact that
the other connections can feature atoms in the residue before
and after in the first and last positions - in bonds, these
tend do be in the first position.</p>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMPatchResidueDefinition.from_block">
<em class="property">classmethod </em><code class="sig-name descname">from_block</code><span class="sig-paren">(</span><em class="sig-param">block: str</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMPatchResidueDefinition.from_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the class from a PRES block in an RTF file. This is
probably the most useful constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>block</strong> – a multi-line string containing the PRES block.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of the class</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMPatchResidueDefinition.is_applicable_to">
<code class="sig-name descname">is_applicable_to</code><span class="sig-paren">(</span><em class="sig-param">residue</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMPatchResidueDefinition.is_applicable_to" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pygen_structures.charmm_containers.CHARMMResidue">
<em class="property">class </em><code class="sig-prename descclassname">pygen_structures.charmm_containers.</code><code class="sig-name descname">CHARMMResidue</code><span class="sig-paren">(</span><em class="sig-param">name: str = 'Unset'</em>, <em class="sig-param">atoms: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">bonds: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">impropers: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">cross_maps: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">ics: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">rtf_file_name: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">first: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">last: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">index: int = 0</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidue" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygen_structures.charmm_containers.CHARMMResidueData" title="pygen_structures.charmm_containers.CHARMMResidueData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygen_structures.charmm_containers.CHARMMResidueData</span></code></a></p>
<p>An actual CHARMM residue, in a molecule. This has an associated
index. The atoms are unchanged from the residue definition
(see <code class="docutils literal notranslate"><span class="pre">CHARMMResidueDefinition</span></code>), but rather than referring to
<code class="docutils literal notranslate"><span class="pre">atom_name</span></code>, the <code class="docutils literal notranslate"><span class="pre">bonds</span></code>, <code class="docutils literal notranslate"><span class="pre">impropers</span></code>, <code class="docutils literal notranslate"><span class="pre">cross_maps</span></code> and <code class="docutils literal notranslate"><span class="pre">ics</span></code> now
refer to <code class="docutils literal notranslate"><span class="pre">atom_ids</span></code>, which are unique atoms rather than general
abstract atoms definitions.</p>
<dl class="simple">
<dt>An <code class="docutils literal notranslate"><span class="pre">atom_id</span></code> takes the following form:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(residue_index:</span> <span class="pre">int,</span> <span class="pre">atom_name:</span> <span class="pre">str)</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>first</strong> – default patch if residue is first in chain. If    None, this defaults to the default first patch of the    <code class="docutils literal notranslate"><span class="pre">CHARMMResidueTopologyFile</span></code> the residue definition is in.</p></li>
<li><p><strong>last</strong> – default patch if residue is last in the chain.    Treated much the same way as <code class="docutils literal notranslate"><span class="pre">first</span></code>.</p></li>
<li><p><strong>index</strong> – the <code class="docutils literal notranslate"><span class="pre">residue_index</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidue.from_residue_definition">
<em class="property">classmethod </em><code class="sig-name descname">from_residue_definition</code><span class="sig-paren">(</span><em class="sig-param">residue_definition: pygen_structures.charmm_containers.CHARMMResidueDefinition</em>, <em class="sig-param">index: int</em>, <em class="sig-param">last_index: (&lt;class 'int'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">next_index: (&lt;class 'int'&gt;</em>, <em class="sig-param">None) = None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidue.from_residue_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <code class="docutils literal notranslate"><span class="pre">CHARMMResidue</span></code> from the residue definition.        This is probably the most useful constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>residue_definition</strong> – <code class="docutils literal notranslate"><span class="pre">CHARMMResidueDefinition</span></code> to clone.</p></li>
<li><p><strong>index</strong> – the <code class="docutils literal notranslate"><span class="pre">residue_index</span></code> of the created residue.</p></li>
<li><p><strong>last_index</strong> – the <code class="docutils literal notranslate"><span class="pre">residue_index</span></code> of the previous residue        in the chain. Used for connections where atoms start with ‘-‘.        Default: index - 1</p></li>
<li><p><strong>last_index</strong> – the <code class="docutils literal notranslate"><span class="pre">residue_index</span></code> of the next residue in        the chain. Used for connections where atoms start with ‘+’.        Default: index - 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the created residue.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pygen_structures.charmm_containers.CHARMMResidueData">
<em class="property">class </em><code class="sig-prename descclassname">pygen_structures.charmm_containers.</code><code class="sig-name descname">CHARMMResidueData</code><span class="sig-paren">(</span><em class="sig-param">name: str = 'Unset'</em>, <em class="sig-param">atoms: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">bonds: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">impropers: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">cross_maps: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">ics: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">rtf_file_name: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for CHARMM residue data. Holds information present in a
residue topology file (RTF) section.</p>
</dd></dl>

<dl class="class">
<dt id="pygen_structures.charmm_containers.CHARMMResidueDefinition">
<em class="property">class </em><code class="sig-prename descclassname">pygen_structures.charmm_containers.</code><code class="sig-name descname">CHARMMResidueDefinition</code><span class="sig-paren">(</span><em class="sig-param">name: str = 'Unset'</em>, <em class="sig-param">atoms: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">bonds: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">impropers: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">cross_maps: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">ics: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">rtf_file_name: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">first: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">last: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueDefinition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygen_structures.charmm_containers.CHARMMResidueData" title="pygen_structures.charmm_containers.CHARMMResidueData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygen_structures.charmm_containers.CHARMMResidueData</span></code></a></p>
<p>Definition of a CHARMM residue. This is a general representation,
and doesn”t have an associated index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – residue name, from RESI record</p></li>
<li><p><strong>atoms</strong> – list of (atom_name, atom_type, partial_charge),    from ATOM records</p></li>
<li><p><strong>bonds</strong> – lists of tuples of 2 <code class="docutils literal notranslate"><span class="pre">atom_name</span></code>, from BOND/DOUB    records. Bonds in DOUB records appear twice.</p></li>
<li><p><strong>impropers</strong> – lists of tuples of 4 <code class="docutils literal notranslate"><span class="pre">atom_name</span></code> from IMPR    records</p></li>
<li><p><strong>cross_maps</strong> – lists of tuples of 8 <code class="docutils literal notranslate"><span class="pre">atom_name</span></code> from CMAP    records</p></li>
<li><p><strong>ics</strong> – list of information present in IC records. The first    4 items are <code class="docutils literal notranslate"><span class="pre">atom_name</span></code>, the last 5 are floats containing bond    length/angle information. Where angle i-j-k-l is an improper,    the third <code class="docutils literal notranslate"><span class="pre">atom_name</span></code> is prefaced with “*”.    The floats are:    the bond length, i-j    the angle, i-j-k    the dihedral (or improper) i-j-k-l    the angle j-k-l    the bond length k-l</p></li>
<li><p><strong>first</strong> – default patch if residue is first in the chain. If    <code class="docutils literal notranslate"><span class="pre">None</span></code>, this defaults to the default first patch of the    <code class="docutils literal notranslate"><span class="pre">CHARMMResidueTopologyFile</span></code> this residue definition is in.</p></li>
<li><p><strong>last</strong> – default patch if residue is last in the chain. Treated    much the same way as <code class="docutils literal notranslate"><span class="pre">first</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueDefinition.from_block">
<em class="property">classmethod </em><code class="sig-name descname">from_block</code><span class="sig-paren">(</span><em class="sig-param">block: str</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueDefinition.from_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the class from a RESI block in an RTF file. This is
probably the most useful constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>block</strong> – a multiline string containing the RESI block.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an instance of the class</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueDefinition.to_fragment_mol">
<code class="sig-name descname">to_fragment_mol</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; rdkit.Chem.rdchem.RWMol<a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueDefinition.to_fragment_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <code class="docutils literal notranslate"><span class="pre">Structure</span> <span class="pre">and</span> <span class="pre">return</span> <span class="pre">the</span> <span class="pre">RDKit</span> <span class="pre">``Mol</span></code> generated.
:return: RDKit <code class="docutils literal notranslate"><span class="pre">RWMol</span></code></p>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueDefinition.to_residue">
<code class="sig-name descname">to_residue</code><span class="sig-paren">(</span><em class="sig-param">index: int</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueDefinition.to_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <code class="docutils literal notranslate"><span class="pre">CHARMMResidue</span></code> from the residue definition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> – the <code class="docutils literal notranslate"><span class="pre">residue_index</span></code> of the created residue.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the created residue</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueDefinition.to_smarts">
<code class="sig-name descname">to_smarts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueDefinition.to_smarts" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <code class="docutils literal notranslate"><span class="pre">Structure</span></code>, grab the RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code>, and call
<code class="docutils literal notranslate"><span class="pre">MolToSMARTS</span></code> after removing hydrogen atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the SMARTS string.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueDefinition.to_structure">
<code class="sig-name descname">to_structure</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; pygen_structures.mol_containers.structure.Structure<a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueDefinition.to_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the residue as a <code class="docutils literal notranslate"><span class="pre">Structure</span></code> object. These can be used
for pattern matching of residues.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the generated <code class="docutils literal notranslate"><span class="pre">Structure</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pygen_structures.charmm_containers.CHARMMResidueTopologyFile">
<em class="property">class </em><code class="sig-prename descclassname">pygen_structures.charmm_containers.</code><code class="sig-name descname">CHARMMResidueTopologyFile</code><span class="sig-paren">(</span><em class="sig-param">file_name: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">residues: (&lt;class 'dict'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">patches: (&lt;class 'dict'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">masses: (&lt;class 'dict'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">first: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">last: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueTopologyFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class which reads and stores patch residues and residues from a
CHARMM RTF or STR file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> – the name of the RTF file.</p></li>
<li><p><strong>residues</strong> – a mapping of residue names to the    <code class="docutils literal notranslate"><span class="pre">CHARMMResidueDefinition</span></code> which represents them.</p></li>
<li><p><strong>patches</strong> – a mapping of patch residue names to the    <code class="docutils literal notranslate"><span class="pre">CHARMMPatchResidueDefinition</span></code> which represents them.</p></li>
<li><p><strong>masses</strong> – a mapping of <code class="docutils literal notranslate"><span class="pre">atom_type</span></code> to mass.</p></li>
<li><p><strong>first</strong> – the name of the patch applied to the first residue    in a chain.</p></li>
<li><p><strong>first</strong> – the name of the patch applied to the last residue    in a chain.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueTopologyFile.add_patch_definition">
<code class="sig-name descname">add_patch_definition</code><span class="sig-paren">(</span><em class="sig-param">patch: pygen_structures.charmm_containers.CHARMMPatchResidueDefinition</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueTopologyFile.add_patch_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a <code class="docutils literal notranslate"><span class="pre">CHARMMPatchResidueDefinition</span></code> to the patches</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>patch</strong> – a <code class="docutils literal notranslate"><span class="pre">CHARMMPatchResidueDefinition</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueTopologyFile.add_residue_definition">
<code class="sig-name descname">add_residue_definition</code><span class="sig-paren">(</span><em class="sig-param">residue: pygen_structures.charmm_containers.CHARMMResidueDefinition</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueTopologyFile.add_residue_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a <code class="docutils literal notranslate"><span class="pre">CHARMMResidueDefinition</span></code> to the residues</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>residue</strong> – a <code class="docutils literal notranslate"><span class="pre">CHARMMResidueDefinition</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueTopologyFile.from_file">
<em class="property">classmethod </em><code class="sig-name descname">from_file</code><span class="sig-paren">(</span><em class="sig-param">rtf_path</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueTopologyFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate the class from a CHARMM RTF file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rtf_path</strong> – path to .rtf/.str file</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueTopologyFile.read_file">
<code class="sig-name descname">read_file</code><span class="sig-paren">(</span><em class="sig-param">rtf_path</em>, <em class="sig-param">update_default_patches=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueTopologyFile.read_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in a CHARMM RTF (or STR) file and add the patches and
residues, updating the default patches if requested.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rtf_path</strong> – path to the .rtf/.str file</p></li>
<li><p><strong>update_default_patches</strong> – bool flag, updates <code class="docutils literal notranslate"><span class="pre">first</span></code>         and <code class="docutils literal notranslate"><span class="pre">last</span></code> if True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pygen_structures.convenience_functions">
<span id="pygen-structures-convenience-functions-module"></span><h2>pygen_structures.convenience_functions module<a class="headerlink" href="#module-pygen_structures.convenience_functions" title="Permalink to this headline">¶</a></h2>
<p>This module contains convenience functions which are likely to be the
main way users interact with the code.</p>
<dl class="function">
<dt id="pygen_structures.convenience_functions.code_to_mol">
<code class="sig-prename descclassname">pygen_structures.convenience_functions.</code><code class="sig-name descname">code_to_mol</code><span class="sig-paren">(</span><em class="sig-param">sequence: str, rtf: pygen_structures.charmm_containers.CHARMMResidueTopologyFile, patches: (typing.Dict[str, typing.List[int]], None) = None, name: (&lt;class 'str'&gt;, None) = None, segid: (&lt;class 'str'&gt;, None) = None, default_histidine='HSE'</em><span class="sig-paren">)</span> &#x2192; pygen_structures.mol_containers.molecule.Molecule<a class="headerlink" href="#pygen_structures.convenience_functions.code_to_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> from one letter protein code.</p>
<p>First and last patches can be supplied in the sequence string by
providing patch names separated by dashes:</p>
<ul class="simple">
<li><p>e.g. <code class="docutils literal notranslate"><span class="pre">'NNEU-AFK-CT2'</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequence</strong> – a sequence of one letter protein codes</p></li>
<li><p><strong>rtf</strong> – a <code class="docutils literal notranslate"><span class="pre">CHARMMResidueTopologyFile</span></code> to supply patch and    residue definitions.</p></li>
<li><p><strong>patches</strong> – a dict mapping patch names to a list of the indices    of the residues they are to be applied to.</p></li>
<li><p><strong>default_histidine</strong> – default histidine version to use.</p></li>
<li><p><strong>name</strong> – name of the molecule for the PSF/PDB</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> with the given sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pygen_structures.convenience_functions.load_charmm_dir">
<code class="sig-prename descclassname">pygen_structures.convenience_functions.</code><code class="sig-name descname">load_charmm_dir</code><span class="sig-paren">(</span><em class="sig-param">directory_root: str = 'default toppar folder location') -&gt; (&lt;class 'pygen_structures.charmm_containers.CHARMMResidueTopologyFile'&gt;</em>, <em class="sig-param">&lt;class 'pygen_structures.charmm_containers.CHARMMParameterFile'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.convenience_functions.load_charmm_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Scans a CHARMM toppar folder and reads in the rtf, prm and str
files to a CHARMMResidueTopologyFile and a CHARMMParameterFile.
Takes the highest version of the same file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>str</strong> – the path to the toppar folder. Defaults to builtin.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">CHARMMResidueTopologyFile</span></code>, <code class="docutils literal notranslate"><span class="pre">CHARMMParameterFile</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pygen_structures.convenience_functions.pdb_to_mol">
<code class="sig-prename descclassname">pygen_structures.convenience_functions.</code><code class="sig-name descname">pdb_to_mol</code><span class="sig-paren">(</span><em class="sig-param">pdb_path: str, rtf: pygen_structures.charmm_containers.CHARMMResidueTopologyFile, patches: (typing.Dict[str, typing.Tuple[int, str]], None) = None, default_histidine: str = 'HSE', kept_chain: str = 'A', segment_name: (&lt;class 'str'&gt;, None) = None</em><span class="sig-paren">)</span> &#x2192; pygen_structures.mol_containers.molecule.Molecule<a class="headerlink" href="#pygen_structures.convenience_functions.pdb_to_mol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pygen_structures.convenience_functions.sequence_to_mol">
<code class="sig-prename descclassname">pygen_structures.convenience_functions.</code><code class="sig-name descname">sequence_to_mol</code><span class="sig-paren">(</span><em class="sig-param">sequence: List[str], rtf: pygen_structures.charmm_containers.CHARMMResidueTopologyFile, patches: (typing.Dict[str, typing.List[int]], None) = None, name: (&lt;class 'str'&gt;, None) = None, segid: (&lt;class 'str'&gt;, None) = None</em><span class="sig-paren">)</span> &#x2192; pygen_structures.mol_containers.molecule.Molecule<a class="headerlink" href="#pygen_structures.convenience_functions.sequence_to_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>A function for the lazy. Calls <code class="docutils literal notranslate"><span class="pre">Molecule.from_sequence</span></code> with the
supplied args.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequence</strong> – a list of CHARMM residue names</p></li>
<li><p><strong>rtf</strong> – a <code class="docutils literal notranslate"><span class="pre">CHARMMResidueTopologyFile</span></code> to supply patch and    residue definitions.</p></li>
<li><p><strong>patches</strong> – a dict mapping patch names to a list of the indices    of the residues they are to be applied to.</p></li>
<li><p><strong>name</strong> – name of the molecule for the PSF/PDB</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> generated from the given sequence.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pygen_structures.tests">
<span id="pygen-structures-tests-module"></span><h2>pygen_structures.tests module<a class="headerlink" href="#module-pygen_structures.tests" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pygen_structures.version">
<span id="pygen-structures-version-module"></span><h2>pygen_structures.version module<a class="headerlink" href="#module-pygen_structures.version" title="Permalink to this headline">¶</a></h2>
<p>Just a version string! Changing the version here will update it
everywhere else it is used in the project.</p>
</div>
<div class="section" id="module-pygen_structures">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pygen_structures" title="Permalink to this headline">¶</a></h2>
<p>pygen-structures (pigeon structures) is a Python utility which allows
for the generation of 3 dimensional molecular structures which can be
used in molecular dynamics or Monte Carlo simulations.</p>
<p>Molecules are generated from a list of residues and patches in the
format of the CHARMM forcefield, and can be written out as valid PSF
and PDB files.</p>
<p>The project contains classes to work with CHARMM topology and parameter
files, classes which represent CHARMM residues and patch residues,
and convenience functions to load CHARMM data and generate molecules
with arbitrary sequences. These molecules can be written out to PSF and
PDB to run simulations.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">pygen-structures</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Travis Hesketh.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/source/pygen_structures.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
