

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pygen_structures.charmm_containers module &mdash; pygen-structures 0.2.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pygen_structures.convenience_functions module" href="pygen_structures.convenience_functions.html" />
    <link rel="prev" title="pygen_structures.mol_containers.structure module" href="pygen_structures.mol_containers.structure.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> pygen-structures
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_line_usage.html">Command Line Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../library_usage.html">Library Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="pygen_structures.html">pygen_structures package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pygen_structures.html#subpackages">Subpackages</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="pygen_structures.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">pygen_structures.charmm_containers module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygen_structures.convenience_functions.html">pygen_structures.convenience_functions module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pygen-structures</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="pygen_structures.html">pygen_structures package</a> &raquo;</li>
        
      <li>pygen_structures.charmm_containers module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/source/pygen_structures.charmm_containers.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-pygen_structures.charmm_containers">
<span id="pygen-structures-charmm-containers-module"></span><h1>pygen_structures.charmm_containers module<a class="headerlink" href="#module-pygen_structures.charmm_containers" title="Permalink to this headline">¶</a></h1>
<p>Module which stores classes intended to deal with CHARMM forcefield
data.</p>
<dl class="class">
<dt id="pygen_structures.charmm_containers.CHARMMParameterFile">
<em class="property">class </em><code class="sig-prename descclassname">pygen_structures.charmm_containers.</code><code class="sig-name descname">CHARMMParameterFile</code><span class="sig-paren">(</span><em class="sig-param">bonds: (&lt;class 'set'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">angles: (&lt;class 'set'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">dihedrals: (&lt;class 'set'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">impropers: (&lt;class 'set'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">cross_maps: (&lt;class 'set'&gt;</em>, <em class="sig-param">None) = None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMParameterFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A parser for CHARMM PRM files. Used for checking that parameters
exist for generated structures.</p>
<p>This class does not contain the values for the parameters, but
does ensure that the parameters themselves are present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bonds</strong> – set of tuples containing 2 <code class="docutils literal notranslate"><span class="pre">atom_type</span></code></p></li>
<li><p><strong>angles</strong> – set of tuples containing 3 <code class="docutils literal notranslate"><span class="pre">atom_type</span></code></p></li>
<li><p><strong>dihedrals</strong> – set of tuples containing 4 <code class="docutils literal notranslate"><span class="pre">atom_type</span></code></p></li>
<li><p><strong>impropers</strong> – set of tuples containing 4 <code class="docutils literal notranslate"><span class="pre">atom_type</span></code></p></li>
<li><p><strong>cross_maps</strong> – set of tuples containing 8 <code class="docutils literal notranslate"><span class="pre">atom_type</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMParameterFile.check_parameters">
<code class="sig-name descname">check_parameters</code><span class="sig-paren">(</span><em class="sig-param">molecule</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMParameterFile.check_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Check a finalized <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> to verify that all the parameters
in the <code class="docutils literal notranslate"><span class="pre">CHARMMParameterFile</span></code> exist for that molecule, returning
<code class="docutils literal notranslate"><span class="pre">True</span></code> if all parameters are present, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMParameterFile.from_file">
<em class="property">classmethod </em><code class="sig-name descname">from_file</code><span class="sig-paren">(</span><em class="sig-param">prm_path: str</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMParameterFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate the class from a CHARMM PRM file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prm_path</strong> – path to the .prm/.str file.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMParameterFile.get_unmatched">
<code class="sig-name descname">get_unmatched</code><span class="sig-paren">(</span><em class="sig-param">molecule</em><span class="sig-paren">)</span> &#x2192; Dict[str, Set[Tuple[str]]]<a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMParameterFile.get_unmatched" title="Permalink to this definition">¶</a></dt>
<dd><p>Check a finalized <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> to verify that all the parameters
in the <code class="docutils literal notranslate"><span class="pre">CHARMMParameterFile</span></code> exist for that molecule, returning
necessary parameters which are missing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molecule</strong> – the <code class="docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dict of parameter type (i.e. ‘bonds’/’angles’) to a         set of tuples containing unmatched <code class="docutils literal notranslate"><span class="pre">atom_type</span></code> tuples.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMParameterFile.read_file">
<code class="sig-name descname">read_file</code><span class="sig-paren">(</span><em class="sig-param">prm_path: str</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMParameterFile.read_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in data from a CHARMM PRM file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prm_path</strong> – path to .prm/.str file</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pygen_structures.charmm_containers.CHARMMPatchResidueDefinition">
<em class="property">class </em><code class="sig-prename descclassname">pygen_structures.charmm_containers.</code><code class="sig-name descname">CHARMMPatchResidueDefinition</code><span class="sig-paren">(</span><em class="sig-param">name: str = 'Unset'</em>, <em class="sig-param">atoms: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">bonds: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">impropers: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">cross_maps: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">ics: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">rtf_file_name: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">deletions: (&lt;class 'set'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">n_residues: int = 1</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMPatchResidueDefinition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygen_structures.charmm_containers.CHARMMResidueData" title="pygen_structures.charmm_containers.CHARMMResidueData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygen_structures.charmm_containers.CHARMMResidueData</span></code></a></p>
<p>Definition of a CHARMM patch residue. As CHARMM patches
can apply to multiple residues, these are more complicated
to represent than the residues they are applied to.</p>
<p><code class="docutils literal notranslate"><span class="pre">atoms</span></code>, <code class="docutils literal notranslate"><span class="pre">bonds</span></code>, <code class="docutils literal notranslate"><span class="pre">impropers</span></code>, <code class="docutils literal notranslate"><span class="pre">cross_maps</span></code> and <code class="docutils literal notranslate"><span class="pre">ics</span></code> are
<code class="docutils literal notranslate"><span class="pre">n_residues</span></code> long lists of the atoms, bonds, impropers,
cross_maps and ics for each residue. This enables these to be
zipped together with the actual residues the patch is to apply them
to.</p>
<p>Atoms, due to their simplicity, are kept as the form they are
stored in the residue:
- (<code class="docutils literal notranslate"><span class="pre">atom_name</span></code>, <code class="docutils literal notranslate"><span class="pre">atom_type</span></code>, <code class="docutils literal notranslate"><span class="pre">charge</span></code>)</p>
<p>In the other representations, atoms are stored as atom references.
These are tuples of <code class="docutils literal notranslate"><span class="pre">(residue_index:</span> <span class="pre">int,</span> <span class="pre">atom_name:</span> <span class="pre">str)</span></code>, where
<code class="docutils literal notranslate"><span class="pre">residue_index</span></code> is a placeholder for the order given in the patch.
- e.g. 2SG1 -&gt; <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">'SG1')</span></code>
- “BOND 1SG1 2SG1” -&gt; <code class="docutils literal notranslate"><span class="pre">((0,</span> <span class="pre">'SG1'),</span> <span class="pre">(1,</span> <span class="pre">'SG1'))</span></code></p>
<p>This is to account for new bonds/impropers/crossmaps/ics which involve
atoms in different residues.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – patch name, from PRES record</p></li>
<li><p><strong>atoms</strong> – an <code class="docutils literal notranslate"><span class="pre">n_residues</span></code> long list of lists containing    <code class="docutils literal notranslate"><span class="pre">(atom_name,</span> <span class="pre">atom_type,</span> <span class="pre">partial_charge)</span></code></p></li>
<li><p><strong>bonds</strong> – an <code class="docutils literal notranslate"><span class="pre">n_residues</span></code> long list of lists containing    tuples of 2 atom references, from BOND/DOUB records. Bonds    in DOUB records appear twice.</p></li>
<li><p><strong>impropers</strong> – an <code class="docutils literal notranslate"><span class="pre">n_residues</span></code> long list of lists containing    tuples of 4 atom references from IMPR records</p></li>
<li><p><strong>cross_maps</strong> – an <code class="docutils literal notranslate"><span class="pre">n_residues</span></code> long list of lists containing    tuples of 8 atom references from CMAP records</p></li>
<li><p><strong>ics</strong> – an <code class="docutils literal notranslate"><span class="pre">n_residues</span></code> long list of lists containing    lists of information present in IC records.    The first 4 items are atom references, the last 5 are floats    containing bond and angle information. Where angle i-j-k-l is an    improper, the third atom name is prefaced with “*”.        The floats are:    the bond length, i-j    the angle, i-j-k    the dihedral (or improper) i-j-k-l    the angle j-k-l    the bond length k-l</p></li>
<li><p><strong>deletions</strong> – set of atom names which are to be deleted from     the residue</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMPatchResidueDefinition.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param">*residues</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMPatchResidueDefinition.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the CHARMM patch to an actual residue (or collection of
actual residues).</p>
<p>Atoms to be deleted are removed from the applicable residues,
with now-dangling bonds/impropers/cross-maps/ICs to these
residues also removed.</p>
<p>New atoms, bonds, impropers, cross_maps and ics are then
appended to the relevant residue.</p>
<p>Bonds are added to the residue which contains the first atom,
all other multi-atom data is added to the residue which
contains the second atom. This is to account for the fact that
the other connections can feature atoms in the residue before
and after in the first and last positions - in bonds, these
tend do be in the first position.</p>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMPatchResidueDefinition.from_block">
<em class="property">classmethod </em><code class="sig-name descname">from_block</code><span class="sig-paren">(</span><em class="sig-param">block: str</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMPatchResidueDefinition.from_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the class from a PRES block in an RTF file. This is
probably the most useful constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>block</strong> – a multi-line string containing the PRES block.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of the class</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMPatchResidueDefinition.is_applicable_to">
<code class="sig-name descname">is_applicable_to</code><span class="sig-paren">(</span><em class="sig-param">residue</em><span class="sig-paren">)</span> &#x2192; Union[None, List[int]]<a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMPatchResidueDefinition.is_applicable_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Work out the positions where the patch can be applied to the
residue. If the patch can be applied, return a list of
positions where the patch can be applied, otherwise return
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>residue</strong> – The <code class="docutils literal notranslate"><span class="pre">CHARMMResidue</span></code> the patch is to be        applied to</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of indices where the residue could be supplied        to the patch, if applicable. Otherwise <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pygen_structures.charmm_containers.CHARMMResidue">
<em class="property">class </em><code class="sig-prename descclassname">pygen_structures.charmm_containers.</code><code class="sig-name descname">CHARMMResidue</code><span class="sig-paren">(</span><em class="sig-param">name: str = 'Unset'</em>, <em class="sig-param">atoms: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">bonds: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">impropers: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">cross_maps: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">ics: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">rtf_file_name: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">first: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">last: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">index: int = 0</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidue" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygen_structures.charmm_containers.CHARMMResidueData" title="pygen_structures.charmm_containers.CHARMMResidueData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygen_structures.charmm_containers.CHARMMResidueData</span></code></a></p>
<p>An actual CHARMM residue, in a molecule. This has an associated
index. The atoms are unchanged from the residue definition
(see <code class="docutils literal notranslate"><span class="pre">CHARMMResidueDefinition</span></code>), but rather than referring to
<code class="docutils literal notranslate"><span class="pre">atom_name</span></code>, the <code class="docutils literal notranslate"><span class="pre">bonds</span></code>, <code class="docutils literal notranslate"><span class="pre">impropers</span></code>, <code class="docutils literal notranslate"><span class="pre">cross_maps</span></code> and <code class="docutils literal notranslate"><span class="pre">ics</span></code> now
refer to <code class="docutils literal notranslate"><span class="pre">atom_ids</span></code>, which are unique atoms rather than general
abstract atoms definitions.</p>
<dl class="simple">
<dt>An <code class="docutils literal notranslate"><span class="pre">atom_id</span></code> takes the following form:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(residue_index:</span> <span class="pre">int,</span> <span class="pre">atom_name:</span> <span class="pre">str)</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>first</strong> – default patch if residue is first in chain. If    None, this defaults to the default first patch of the    <code class="docutils literal notranslate"><span class="pre">CHARMMResidueTopologyFile</span></code> the residue definition is in.</p></li>
<li><p><strong>last</strong> – default patch if residue is last in the chain.    Treated much the same way as <code class="docutils literal notranslate"><span class="pre">first</span></code>.</p></li>
<li><p><strong>index</strong> – the <code class="docutils literal notranslate"><span class="pre">residue_index</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidue.from_residue_definition">
<em class="property">classmethod </em><code class="sig-name descname">from_residue_definition</code><span class="sig-paren">(</span><em class="sig-param">residue_definition: pygen_structures.charmm_containers.CHARMMResidueDefinition</em>, <em class="sig-param">index: int</em>, <em class="sig-param">last_index: (&lt;class 'int'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">next_index: (&lt;class 'int'&gt;</em>, <em class="sig-param">None) = None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidue.from_residue_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <code class="docutils literal notranslate"><span class="pre">CHARMMResidue</span></code> from the residue definition.        This is probably the most useful constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>residue_definition</strong> – <code class="docutils literal notranslate"><span class="pre">CHARMMResidueDefinition</span></code> to clone.</p></li>
<li><p><strong>index</strong> – the <code class="docutils literal notranslate"><span class="pre">residue_index</span></code> of the created residue.</p></li>
<li><p><strong>last_index</strong> – the <code class="docutils literal notranslate"><span class="pre">residue_index</span></code> of the previous residue        in the chain. Used for connections where atoms start with ‘-‘.        Default: index - 1</p></li>
<li><p><strong>last_index</strong> – the <code class="docutils literal notranslate"><span class="pre">residue_index</span></code> of the next residue in        the chain. Used for connections where atoms start with ‘+’.        Default: index - 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the created residue.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pygen_structures.charmm_containers.CHARMMResidueData">
<em class="property">class </em><code class="sig-prename descclassname">pygen_structures.charmm_containers.</code><code class="sig-name descname">CHARMMResidueData</code><span class="sig-paren">(</span><em class="sig-param">name: str = 'Unset'</em>, <em class="sig-param">atoms: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">bonds: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">impropers: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">cross_maps: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">ics: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">rtf_file_name: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for CHARMM residue data. Holds information present in a
residue topology file (RTF) section.</p>
</dd></dl>

<dl class="class">
<dt id="pygen_structures.charmm_containers.CHARMMResidueDefinition">
<em class="property">class </em><code class="sig-prename descclassname">pygen_structures.charmm_containers.</code><code class="sig-name descname">CHARMMResidueDefinition</code><span class="sig-paren">(</span><em class="sig-param">name: str = 'Unset'</em>, <em class="sig-param">atoms: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">bonds: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">impropers: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">cross_maps: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">ics: (&lt;class 'list'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">rtf_file_name: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">first: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">last: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueDefinition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygen_structures.charmm_containers.CHARMMResidueData" title="pygen_structures.charmm_containers.CHARMMResidueData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygen_structures.charmm_containers.CHARMMResidueData</span></code></a></p>
<p>Definition of a CHARMM residue. This is a general representation,
and doesn’t have an associated index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – residue name, from RESI record</p></li>
<li><p><strong>atoms</strong> – list of (atom_name, atom_type, partial_charge),    from ATOM records</p></li>
<li><p><strong>bonds</strong> – lists of tuples of 2 <code class="docutils literal notranslate"><span class="pre">atom_name</span></code>, from BOND/DOUB    records. Bonds in DOUB records appear twice.</p></li>
<li><p><strong>impropers</strong> – lists of tuples of 4 <code class="docutils literal notranslate"><span class="pre">atom_name</span></code> from IMPR    records</p></li>
<li><p><strong>cross_maps</strong> – lists of tuples of 8 <code class="docutils literal notranslate"><span class="pre">atom_name</span></code> from CMAP    records</p></li>
<li><p><strong>ics</strong> – list of information present in IC records. The first    4 items are <code class="docutils literal notranslate"><span class="pre">atom_name</span></code>, the last 5 are floats containing bond    length/angle information. Where angle i-j-k-l is an improper,    the third <code class="docutils literal notranslate"><span class="pre">atom_name</span></code> is prefaced with “*”.    The floats are:    the bond length, i-j    the angle, i-j-k    the dihedral (or improper) i-j-k-l    the angle j-k-l    the bond length k-l</p></li>
<li><p><strong>first</strong> – default patch if residue is first in the chain. If    <code class="docutils literal notranslate"><span class="pre">None</span></code>, this defaults to the default first patch of the    <code class="docutils literal notranslate"><span class="pre">CHARMMResidueTopologyFile</span></code> this residue definition is in.</p></li>
<li><p><strong>last</strong> – default patch if residue is last in the chain. Treated    much the same way as <code class="docutils literal notranslate"><span class="pre">first</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueDefinition.from_block">
<em class="property">classmethod </em><code class="sig-name descname">from_block</code><span class="sig-paren">(</span><em class="sig-param">block: str</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueDefinition.from_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the class from a RESI block in an RTF file. This is
probably the most useful constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>block</strong> – a multiline string containing the RESI block.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an instance of the class</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueDefinition.to_fragment_mol">
<code class="sig-name descname">to_fragment_mol</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; rdkit.Chem.rdchem.RWMol<a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueDefinition.to_fragment_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <code class="docutils literal notranslate"><span class="pre">Structure</span> <span class="pre">and</span> <span class="pre">return</span> <span class="pre">the</span> <span class="pre">RDKit</span> <span class="pre">``Mol</span></code> generated.
:return: RDKit <code class="docutils literal notranslate"><span class="pre">RWMol</span></code></p>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueDefinition.to_residue">
<code class="sig-name descname">to_residue</code><span class="sig-paren">(</span><em class="sig-param">index: int</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueDefinition.to_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <code class="docutils literal notranslate"><span class="pre">CHARMMResidue</span></code> from the residue definition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> – the <code class="docutils literal notranslate"><span class="pre">residue_index</span></code> of the created residue.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the created residue</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pygen_structures.charmm_containers.CHARMMResidue" title="pygen_structures.charmm_containers.CHARMMResidue">CHARMMResidue</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueDefinition.to_smarts">
<code class="sig-name descname">to_smarts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueDefinition.to_smarts" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <code class="docutils literal notranslate"><span class="pre">Structure</span></code>, grab the RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code>, and call
<code class="docutils literal notranslate"><span class="pre">MolToSMARTS</span></code> after removing hydrogen atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the SMARTS string.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueDefinition.to_structure">
<code class="sig-name descname">to_structure</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; pygen_structures.mol_containers.structure.Structure<a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueDefinition.to_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the residue as a <code class="docutils literal notranslate"><span class="pre">Structure</span></code> object. These can be used
for pattern matching of residues.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the generated <code class="docutils literal notranslate"><span class="pre">Structure</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pygen_structures.charmm_containers.CHARMMResidueTopologyFile">
<em class="property">class </em><code class="sig-prename descclassname">pygen_structures.charmm_containers.</code><code class="sig-name descname">CHARMMResidueTopologyFile</code><span class="sig-paren">(</span><em class="sig-param">file_name: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">residues: (&lt;class 'dict'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">patches: (&lt;class 'dict'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">masses: (&lt;class 'dict'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">first: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em>, <em class="sig-param">last: (&lt;class 'str'&gt;</em>, <em class="sig-param">None) = None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueTopologyFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class which reads and stores patch residues and residues from a
CHARMM RTF or STR file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> – the name of the RTF file.</p></li>
<li><p><strong>residues</strong> – a mapping of residue names to the    <code class="docutils literal notranslate"><span class="pre">CHARMMResidueDefinition</span></code> which represents them.</p></li>
<li><p><strong>patches</strong> – a mapping of patch residue names to the    <code class="docutils literal notranslate"><span class="pre">CHARMMPatchResidueDefinition</span></code> which represents them.</p></li>
<li><p><strong>masses</strong> – a mapping of <code class="docutils literal notranslate"><span class="pre">atom_type</span></code> to mass.</p></li>
<li><p><strong>first</strong> – the name of the patch applied to the first residue    in a chain.</p></li>
<li><p><strong>last</strong> – the name of the patch applied to the last residue    in a chain.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueTopologyFile.add_patch_definition">
<code class="sig-name descname">add_patch_definition</code><span class="sig-paren">(</span><em class="sig-param">patch: pygen_structures.charmm_containers.CHARMMPatchResidueDefinition</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueTopologyFile.add_patch_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a <code class="docutils literal notranslate"><span class="pre">CHARMMPatchResidueDefinition</span></code> to the patches</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>patch</strong> – a <code class="docutils literal notranslate"><span class="pre">CHARMMPatchResidueDefinition</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueTopologyFile.add_residue_definition">
<code class="sig-name descname">add_residue_definition</code><span class="sig-paren">(</span><em class="sig-param">residue: pygen_structures.charmm_containers.CHARMMResidueDefinition</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueTopologyFile.add_residue_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a <code class="docutils literal notranslate"><span class="pre">CHARMMResidueDefinition</span></code> to the residues</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>residue</strong> – a <code class="docutils literal notranslate"><span class="pre">CHARMMResidueDefinition</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueTopologyFile.from_file">
<em class="property">classmethod </em><code class="sig-name descname">from_file</code><span class="sig-paren">(</span><em class="sig-param">rtf_path: str</em><span class="sig-paren">)</span><a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueTopologyFile.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate the class from a CHARMM RTF file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rtf_path</strong> – path to .rtf/.str file</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygen_structures.charmm_containers.CHARMMResidueTopologyFile.read_file">
<code class="sig-name descname">read_file</code><span class="sig-paren">(</span><em class="sig-param">rtf_path: str</em>, <em class="sig-param">update_default_patches=False</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#pygen_structures.charmm_containers.CHARMMResidueTopologyFile.read_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in a CHARMM RTF (or STR) file and add the patches and
residues, updating the default patches if requested.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rtf_path</strong> – path to the .rtf/.str file</p></li>
<li><p><strong>update_default_patches</strong> – bool flag, updates <code class="docutils literal notranslate"><span class="pre">first</span></code>         and <code class="docutils literal notranslate"><span class="pre">last</span></code> if True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pygen_structures.convenience_functions.html" class="btn btn-neutral float-right" title="pygen_structures.convenience_functions module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pygen_structures.mol_containers.structure.html" class="btn btn-neutral float-left" title="pygen_structures.mol_containers.structure module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Travis Hesketh

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>